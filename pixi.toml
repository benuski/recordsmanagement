[workspace]
name = "marker-pdf-bleeding"
channels = ["conda-forge"]
platforms = ["linux-64"]

[dependencies]
python = "3.11.*"
# Fix 1: Pin Pillow to <11 to satisfy Marker 1.10
pillow = { version = ">=10.1,<11", channel = "conda-forge" }

# Fix 2: Keep Transformers pinned to 4.48 to avoid 'QuantizedCacheConfig' crash
transformers = { version = ">=4.45.2,<5.0.0", channel = "conda-forge" }

# Standard compatibility pins
libjpeg-turbo = { version = "*", channel = "conda-forge" }
numpy = { version = "<2", channel = "conda-forge" }
regex = { version = "<2025", channel = "conda-forge" }

[pypi-dependencies]
# Pull bleeding-edge PyTorch 
torch = { version = ">=2.5" } 
torchvision = { version = "*" }
marker-pdf = ">=1.10"
img2table = ">=1.4.2, <2"
surya-ocr = ">=0.17.1, <0.18"
pdfplumber = ">=0.11.9, <0.12"

[pypi-options]
# We use the cu124 nightly stream which is more likely to have the newer versions
extra-index-urls = ["https://download.pytorch.org/whl/nightly/cu128-full"]

[system-requirements]
cuda = "12.8"
